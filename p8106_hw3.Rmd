---
title: "p8106 hw3"
author: "Nathalie Fadel"
date: "4/8/2019"
output: github_document
---

###Import & view data
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(caret)
library(ISLR)
library(AppliedPredictiveModeling)
library(glmnet)
data("Weekly")

summary(Weekly)

```

###Plot
```{r}
transparentTheme(trans = .4)
featurePlot(x = Weekly[, 1:8], 
            y = Weekly$Direction,
            scales = list(x=list(relation="free"), 
                        y=list(relation="free")),
            plot = "density", pch = "|", 
            auto.key = list(columns = 2))

```
```{r}
set.seed(1)
rowTrain <- createDataPartition(y = Weekly$Direction, p = 0.75, list = FALSE)

glm.fit <- glm(Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, 
               data = Weekly, 
               subset = rowTrain, 
               family = binomial)

contrasts(Weekly$Direction)

#Using caret
ctrl <- trainControl(method = "repeatedcv",
                     repeats = 5,
                     summaryFunction = twoClassSummary,
                     classProbs = TRUE)
set.seed(1)
model.glm <- train(x = Weekly[rowTrain,1:8],
                   y = Weekly$Direction[rowTrain],
                   method = "glm",
                   metric = "ROC",
                   trControl = ctrl)

```
